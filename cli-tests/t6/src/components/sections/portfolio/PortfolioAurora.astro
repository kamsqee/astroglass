---
/**
 * Portfolio Aurora - Aurora Masonry Lightbox
 * Grid layout with gradient-border frames, category filter pills,
 * and hover effects with overlay text reveal.
 */
import { getLocaleFromUrl, useTranslations } from '../../../utils/i18n';
import LocalizedLink from '../../ui/LocalizedLink.astro';

const locale = getLocaleFromUrl(Astro.url);
const t = useTranslations(locale);
import '../../../styles/components/portfolio/PortfolioAurora.css';

const categories = [
  { id: 'all', label: t('portfolio.allWork') },
  { id: 'webapp', label: t('portfolio.categories.webapp') },
  { id: 'dashboard', label: t('portfolio.categories.dashboard') },
  { id: 'mobile', label: t('portfolio.categories.mobile') },
  { id: 'branding', label: t('portfolio.categories.branding') },
];

const projects = [
  {
    title: t('portfolio.p1Title'),
    desc: t('portfolio.p1Desc'),
    category: 'webapp',
    metric: '3.2x',
    metricLabel: t('portfolio.metrics.faster'),
    span: 'tall',
  },
  {
    title: t('portfolio.p2Title'),
    desc: t('portfolio.p2Desc'),
    category: 'dashboard',
    metric: '50K+',
    metricLabel: t('portfolio.metrics.users'),
    span: 'wide',
  },
  {
    title: t('portfolio.p3Title'),
    desc: t('portfolio.p3Desc'),
    category: 'mobile',
    metric: '4.9',
    metricLabel: t('portfolio.metrics.rating'),
    span: 'normal',
  },
  {
    title: t('portfolio.p4Title'),
    desc: t('portfolio.p4Desc'),
    category: 'branding',
    metric: '280%',
    metricLabel: t('portfolio.metrics.growth'),
    span: 'normal',
  },
];
---

<section class="portfolio-aurora" id="portfolio">
  <!-- Header -->
  <div class="portfolio-aurora-header">
    <div class="portfolio-aurora-label">
      <span class="portfolio-aurora-label-frame">▮▯▮</span>
      <span>{t('portfolio.badge')}</span>
    </div>
    <h2 class="portfolio-aurora-title">{t('portfolio.title')}</h2>
    <p class="portfolio-aurora-subtitle">{t('portfolio.subtitle')}</p>
  </div>

  <div class="portfolio-aurora-filters mb-10 md:mb-12 flex justify-center flex-wrap gap-2" id="aurora-portfolio-filters">
    {categories.map((cat, i) => (
      <button
        class:list={['portfolio-aurora-filter', i === 0 ? 'is-active' : '']}
        data-filter={cat.id}
      >
        {cat.label}
      </button>
    ))}
  </div>

  <!-- Grid -->
  <div class="max-w-[1100px] mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 sm:gap-6" id="aurora-portfolio-grid">
    {projects.map((p) => (
      <div class:list={['pp-aurora__card group cursor-pointer', `portfolio-aurora-item--${p.span}`]} data-category={p.category}>
        
        <div class="pp-aurora__visual" data-category={p.category}>
          <div class="pp-aurora__visual-mesh"></div>
          <div class="pp-aurora__visual-grid"></div>
          <span class="pp-aurora__visual-icon group-hover:scale-110 transition-transform duration-300">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2.5C12 2.5 4 10 4 14.5C4 18.92 7.58 22.5 12 22.5C16.42 22.5 20 18.92 20 14.5C20 10 12 2.5 12 2.5Z"/>
              <path d="M8.5 14L12 8L15.5 14L12 18Z"/>
            </svg>
          </span>

          <div class="pp-aurora__badge">
            {categories.find(c => c.id === p.category)?.label}
          </div>

          <div class="pp-aurora__float-metric">
            <span class="pp-aurora__float-metric-value">{p.metric}</span>
            <span class="pp-aurora__float-metric-label">{p.metricLabel}</span>
          </div>
        </div>

        <!-- Overlay on hover (Desktop) / Normal content (Mobile) -->
        <div class="portfolio-aurora-overlay">
          <div class="portfolio-aurora-overlay-content">
            <span class="portfolio-aurora-overlay-cat">{categories.find(c => c.id === p.category)?.label}</span>
            <h3 class="portfolio-aurora-overlay-title">{p.title}</h3>
            <p class="portfolio-aurora-overlay-desc">{p.desc}</p>
            
            <LocalizedLink href="/aurora/portfolio" class="portfolio-aurora-overlay-link">
              {t('portfolio.viewProject')}
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M5 12h14M12 5l7 7-7 7"/>
              </svg>
            </LocalizedLink>
          </div>
        </div>
      </div>
    ))}
  </div>
</section>

<script>
  import { registerAstroPage } from '../../../utils/lifecycle';
  import { initScrollReveal } from '../../../utils/animations';
  import { initCategoryFilter } from '../../../utils/portfolio';

  registerAstroPage((signal) => {
    initScrollReveal('.pp-aurora__card', {
      threshold: 0.1,
      rootMargin: '0px 0px -30px 0px',
      staggerMs: 80,
      signal,
    });

    initCategoryFilter({
      filtersId: 'aurora-portfolio-filters',
      cardSelector: '.pp-aurora__card',
      activeClasses: ['is-active'],
      inactiveClasses: [],
      twoStepAnimation: true,
      hideTransform: 'translateY(20px) scale(0.98)',
      signal,
    });
  });
</script>
