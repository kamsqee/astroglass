---
/**
 * Features Liquid - Liquid Flow (Distinctive)
 * Organic card shapes, water-themed SVG icons, liquid fill hover effect.
 */
import { useTranslations } from '../../../utils/i18n';
import { getLocaleFromUrl } from '../../../utils/locale-utils';

const locale = getLocaleFromUrl(Astro.url);
const t = useTranslations(locale);

const features = [
  { id: 1, title: t('features.f1Title'), desc: t('features.f1Desc'), iconId: 'droplet', priority: true, organic: 1 },
  { id: 2, title: t('features.f2Title'), desc: t('features.f2Desc'), iconId: 'wave', priority: false, organic: 2 },
  { id: 3, title: t('features.f3Title'), desc: t('features.f3Desc'), iconId: 'ripple', priority: false, organic: 3 },
  { id: 4, title: t('features.f4Title'), desc: t('features.f4Desc'), iconId: 'flow', priority: false, organic: 4 },
  { id: 5, title: t('features.f5Title'), desc: t('features.f5Desc'), iconId: 'globe', priority: false, organic: 1 },
];

const iconPaths: Record<string, string> = {
  droplet: 'M12 2C12 2 5.5 11 5.5 15.5C5.5 19.09 8.41 22 12 22C15.59 22 18.5 19.09 18.5 15.5C18.5 11 12 2 12 2Z',
  wave: 'M2 12C2 12 5 8 8 8C11 8 11 16 14 16C17 16 20 12 22 12M2 17C2 17 5 13 8 13C11 13 11 21 14 21C17 21 20 17 22 17M2 7C2 7 5 3 8 3C11 3 11 11 14 11C17 11 20 7 22 7',
  ripple: 'M12 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0-4 0M12 12m-6 0a6 6 0 1 0 12 0a6 6 0 1 0-12 0M12 12m-10 0a10 10 0 1 0 20 0a10 10 0 1 0-20 0',
  flow: 'M5 5C5 5 5 12 12 12C19 12 19 19 19 19M5 12C5 12 5 19 12 19M12 5C12 5 12 12 19 12',
  globe: 'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z',
};
import '../../../styles/components/features/FeaturesLiquid.css';
import LiquidSectionTag from '../../ui/liquid/LiquidSectionTag.astro';
---

<section id="services" class="relative py-16 sm:py-24 md:py-32 px-4 sm:px-6 overflow-hidden">
  <div class="max-w-7xl mx-auto">
      <!-- Header -->
      <div class="text-center mb-12 sm:mb-16 md:mb-20">
        <LiquidSectionTag label={t('features.badge')} class="mb-6" />
        <h2 class="text-4xl sm:text-5xl md:text-7xl font-black text-base-content mb-6 tracking-tight leading-none">
          {t('features.title')}
        </h2>
      <p class="text-base sm:text-lg md:text-xl text-base-content/75 max-w-2xl mx-auto font-medium leading-relaxed">
        {t('features.subtitle')}
      </p>
    </div>

    <!-- Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-4 sm:gap-6 md:gap-8">
      {features.map((f, i) => (
        <div class:list={[
          "c-features-liquid__card relative group",
          f.priority ? "lg:col-span-8" : "lg:col-span-4"
        ]} style={`animation-delay: ${i * 100}ms`}>
          <div class:list={[
            `c-features-liquid__card-inner c-features-liquid__card-inner--organic-${f.organic} relative h-full backdrop-blur-xl border flex flex-col justify-between overflow-hidden transition-all duration-700`,
            f.priority 
              ? "bg-gradient-to-br from-accent/5 to-primary/5 border-accent/20 p-6 sm:p-8 md:p-12" 
              : "bg-base-content/[0.02] border-base-content/5 p-6 sm:p-8 md:p-10 hover:bg-base-content/[0.04] hover:border-base-content/15"
          ]}>
            <!-- Priority badge -->
            {f.priority && (
              <div class="absolute top-4 right-4 sm:top-6 sm:right-6 px-3 py-1 rounded-full bg-accent/20 text-accent text-[10px] font-bold uppercase tracking-wider">
                {t('features.coreBadge')}
              </div>
            )}
            
            <!-- Glow on hover -->
            <div class="absolute -top-1/2 -right-1/2 w-full h-full bg-accent/10 blur-[100px] rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-700 pointer-events-none"></div>
            
            <!-- Liquid SVG Icon (organic blob shape) -->
            <div class="c-features-liquid__icon-box w-12 h-12 sm:w-14 sm:h-14 bg-accent/10 border border-accent/10 flex items-center justify-center mb-6 sm:mb-8 relative z-10">
              <svg class="c-features-liquid__icon-svg w-6 h-6 sm:w-7 sm:h-7 text-base-content/75" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d={iconPaths[f.iconId]} />
              </svg>
            </div>

            <!-- Content -->
            <div class="relative z-10">
              <h3 class="text-xl sm:text-2xl md:text-3xl font-black text-base-content mb-3 tracking-tight group-hover:text-accent transition-colors duration-500">
                {f.title}
              </h3>
              <p class="text-sm sm:text-base md:text-lg text-base-content/75 leading-relaxed group-hover:text-base-content/70 transition-colors duration-500">
                {f.desc}
              </p>
            </div>
            
            <!-- Bottom accent line (liquid flow) -->
            <div class:list={[
              "absolute bottom-0 h-1 bg-gradient-to-r from-accent to-primary rounded-full transition-all duration-1000",
              i % 2 === 0 ? "left-0 w-0 group-hover:w-full" : "right-0 w-0 group-hover:w-full"
            ]}></div>
          </div>
        </div>
      ))}
    </div>

    <!-- Section CTA -->
    <div class="text-center mt-12 sm:mt-16">
      <a href={`/${locale}/docs`} class="inline-flex items-center gap-3 text-accent font-bold hover:gap-5 transition-all duration-500 group">
        {t('features.exploreAll')}
        <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
        </svg>
      </a>
    </div>
  </div>
</section>
