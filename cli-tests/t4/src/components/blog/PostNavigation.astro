---
import { useTranslations } from '../../utils/i18n';
import { getLocaleFromUrl } from '../../utils/locale-utils';
import LocalizedLink from '../ui/LocalizedLink.astro';

interface PostRef {
  slug: string;
  title: string;
}

interface Props {
  prevPost?: PostRef;
  nextPost?: PostRef;
}

const { prevPost, nextPost } = Astro.props;
const locale = getLocaleFromUrl(Astro.url);
const t = useTranslations(locale);

function postHref(slug: string) {
  const cleanSlug = slug.replace(/^[a-z]{2}\//, '');
  return `/blog/${cleanSlug}/`;
}
---

{(prevPost || nextPost) && (
  <nav class="post-nav" aria-label="Post navigation">
    <div class="post-nav__inner">
      {prevPost ? (
        <LocalizedLink href={postHref(prevPost.slug)} class="post-nav__link post-nav__link--prev">
          <span class="post-nav__label">{t('blog.prevPost')}</span>
          <span class="post-nav__title">{prevPost.title}</span>
        </LocalizedLink>
      ) : <div />}
      {nextPost ? (
        <LocalizedLink href={postHref(nextPost.slug)} class="post-nav__link post-nav__link--next">
          <span class="post-nav__label">{t('blog.nextPost')}</span>
          <span class="post-nav__title">{nextPost.title}</span>
        </LocalizedLink>
      ) : <div />}
    </div>
  </nav>
)}

<style>
  .post-nav {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid hsl(var(--bc) / 0.06);
  }

  .post-nav__inner {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    max-width: 65ch;
    margin: 0 auto;
  }

  .post-nav__link {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    padding: 1rem 1.25rem;
    border-radius: 0.75rem;
    background: hsl(var(--bc) / 0.03);
    border: 1px solid hsl(var(--bc) / 0.06);
    text-decoration: none;
    transition: all 0.2s ease;
  }

  .post-nav__link:hover {
    background: hsl(var(--a) / 0.06);
    border-color: hsl(var(--a) / 0.15);
  }

  .post-nav__link--prev {
    text-align: left;
  }

  .post-nav__link--next {
    text-align: right;
  }

  .post-nav__label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: hsl(var(--bc) / 0.35);
  }

  .post-nav__title {
    font-size: 1rem;
    font-weight: 700;
    color: hsl(var(--bc) / 0.8);
    line-height: 1.3;
    transition: color 0.2s ease;
  }

  .post-nav__link:hover .post-nav__title {
    color: hsl(var(--a));
  }

  @media (min-width: 640px) {
    .post-nav__inner {
      grid-template-columns: 1fr 1fr;
    }
  }
</style>
