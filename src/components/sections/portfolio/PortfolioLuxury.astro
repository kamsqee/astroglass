---
/**
 * Portfolio Luxury - Case Study Cards (Redesigned)
 * Metric-led narrative cards with impact focus.
 */
import '../../../styles/components/portfolio/PortfolioPageLuxury.css';
import { useTranslations } from '../../../utils/i18n';
import { getLocaleFromUrl } from '../../../utils/locale-utils';
import LocalizedLink from '../../ui/LocalizedLink.astro';
import LuxuryButton from '../../ui/luxury/LuxuryButton.astro';
import LuxuryCard from '../../ui/luxury/LuxuryCard.astro';
import LuxurySectionLabel from '../../ui/luxury/LuxurySectionLabel.astro';

const locale = getLocaleFromUrl(Astro.url);
const t = useTranslations(locale);
const projects = [
  { 
    id: 1, 
    title: t('portfolio.p1Title'), 
    desc: t('portfolio.p1Desc'), 
    category: t('portfolio.categories.webapp'),
    metric: '3x',
    metricLabel: t('portfolio.metrics.faster'),
    color: 'from-violet-500 to-purple-600'
  },
  { 
    id: 2, 
    title: t('portfolio.p2Title'), 
    desc: t('portfolio.p2Desc'), 
    category: t('portfolio.categories.dashboard'),
    metric: '50K+',
    metricLabel: t('portfolio.metrics.users'),
    color: 'from-cyan-500 to-blue-600'
  },
  { 
    id: 3, 
    title: t('portfolio.p3Title'), 
    desc: t('portfolio.p3Desc'), 
    category: t('portfolio.categories.mobile'),
    metric: '4.9â˜…',
    metricLabel: t('portfolio.metrics.rating'),
    color: 'from-emerald-500 to-teal-600'
  },
  { 
    id: 4, 
    title: t('portfolio.p4Title'), 
    desc: t('portfolio.p4Desc'), 
    category: t('portfolio.categories.branding'),
    metric: '200%',
    metricLabel: t('portfolio.metrics.growth'),
    color: 'from-amber-500 to-orange-600'
  },
];
---

<section id="portfolio" class="relative py-20 md:py-32 px-4 sm:px-6 lg:px-8 overflow-hidden bg-base-100">
  <div class="max-w-6xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-12 sm:mb-16">
      <div class="mb-4 flex justify-center">
        <LuxurySectionLabel text={t('portfolio.caseStudies')} />
      </div>
      <h2 class="text-4xl sm:text-5xl md:text-6xl font-normal font-serif text-base-content tracking-tight mb-4">
        {t('portfolio.impactTitle')}
      </h2>
      <p class="text-base sm:text-lg text-base-content/75 max-w-xl mx-auto">
        {t('portfolio.impactSubtitle')}
      </p>
    </div>

    <!-- Case Study Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
      {projects.map((p, i) => (
        <LuxuryCard class="group c-portfolio-page-luxury__card" spotlight={true} hover={false}>
          <!-- Background gradient -->
          <div class={`absolute inset-0 bg-gradient-to-br ${p.color} opacity-[0.03] group-hover:opacity-[0.08] transition-opacity duration-luxury-slow`}></div>
          
          <!-- Large number watermark -->
          <div class="absolute -bottom-8 -right-4 text-[140px] sm:text-[180px] font-black text-base-content/[0.03] leading-none select-none pointer-events-none">
            0{p.id}
          </div>
          
          <div class="relative z-10 p-6 sm:p-8 lg:p-10 min-h-[280px] sm:min-h-[320px] flex flex-col">
            <!-- Top: Category -->
            <div class="flex items-center justify-between mb-6">
              <span class="px-3 py-1.5 rounded-lg bg-base-content/5 text-base-content/75 text-[10px] font-bold uppercase tracking-luxury-wide">
                {p.category}
              </span>
              <div class={`w-8 h-8 rounded-lg bg-gradient-to-br ${p.color} opacity-60 group-hover:opacity-100 group-hover:scale-110 transition-luxury`}></div>
            </div>
            
            <!-- Middle: Metric (Visual Anchor) -->
            <div class="mb-6">
              <div class={`text-4xl sm:text-5xl lg:text-6xl font-black bg-gradient-to-r ${p.color} bg-clip-text text-transparent mb-1`}>
                {p.metric}
              </div>
              <span class="text-sm text-base-content/75 font-medium">{p.metricLabel}</span>
            </div>
            
            <!-- Bottom: Title & Description -->
            <div class="mt-auto">
              <h3 class="text-xl sm:text-2xl font-black text-base-content mb-2 group-hover:text-accent transition-colors duration-luxury-medium">
                {p.title}
              </h3>
              <p class="text-sm text-base-content/75 leading-relaxed mb-4">
                {p.desc}
              </p>
              
              <!-- CTA -->
              <!-- CTA -->
              <LocalizedLink href="/luxury/portfolio" class="inline-flex items-center gap-2 text-accent text-xs font-bold relative z-20">
                {t('portfolio.viewCaseStudy')}
                <svg class="w-3 h-3 transition-transform duration-300 group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                </svg>
              </LocalizedLink>
            </div>
          </div>
        </LuxuryCard>
      ))}
    </div>

    <!-- Bottom CTA -->
    <div class="text-center mt-12 sm:mt-16">
      <LuxuryButton href="/luxury/portfolio" variant="primary">
        {t('portfolio.allWork')}
      </LuxuryButton>
    </div>
  </div>
</section>

<script>
  import { registerAstroPage } from '../../../utils/lifecycle';
  import { initScrollReveal } from '../../../utils/animations';

  registerAstroPage((signal) => {
    initScrollReveal('.c-portfolio-page-luxury__card', {
      threshold: 0.1,
      rootMargin: '0px 0px -40px 0px',
      staggerMs: 80,
      signal,
    });
  });
</script>
