---
import { useTranslations } from '../../utils/i18n';
import { getLocaleFromUrl } from '../../utils/locale-utils';
import LocalizedLink from '../ui/LocalizedLink.astro';

interface Props {
  tags: string[];
  activeTag?: string;
  basePath?: string;
}

const { tags, activeTag, basePath = '/blog' } = Astro.props;
const locale = getLocaleFromUrl(Astro.url);
const t = useTranslations(locale);
const blogBase = basePath;
---

<nav class="tag-filter" aria-label={t('blog.filterByTag')}>
  <div class="tag-filter__track scrollbar-hide">
    <a
      href={blogBase}
      class={`tag-filter__pill ${!activeTag ? 'tag-filter__pill--active' : ''}`}
    >
      {t('blog.allPosts')}
    </LocalizedLink>
    {tags.map(tag => (
      <a
        href={`${blogBase}/tag/${tag}/`}
        class={`tag-filter__pill ${activeTag === tag ? 'tag-filter__pill--active' : ''}`}
      >
        {tag}
      </LocalizedLink>
    ))}
  </div>
</nav>

<style>
  .tag-filter {
    margin-bottom: 2rem;
  }

  .tag-filter__track {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.25rem;
    -webkit-overflow-scrolling: touch;
  }

  .tag-filter__pill {
    flex-shrink: 0;
    display: inline-flex;
    align-items: center;
    padding: 0.375rem 1rem;
    border-radius: 9999px;
    font-size: 0.8125rem;
    font-weight: 600;
    color: hsl(var(--bc) / 0.5);
    background: hsl(var(--bc) / 0.04);
    border: 1px solid hsl(var(--bc) / 0.06);
    text-decoration: none;
    white-space: nowrap;
    transition: all 0.2s ease;
  }

  .tag-filter__pill:hover {
    color: hsl(var(--bc) / 0.8);
    background: hsl(var(--bc) / 0.08);
  }

  .tag-filter__pill--active {
    color: hsl(var(--b1));
    background: hsl(var(--a));
    border-color: hsl(var(--a));
  }

  .tag-filter__pill--active:hover {
    color: hsl(var(--b1));
    opacity: 0.9;
  }
</style>
