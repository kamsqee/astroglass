---
<%# portfolio.astro — generated by create-astroglass CLI %>
/**
 * Portfolio Page — Dynamic Route
 *
 * Generates /{theme}/portfolio for each enabled theme.
 */
import BaseLayout from '../../../layouts/BaseLayout.astro';
import { useTranslations } from '../../../utils/i18n';
import { getLocaleFromUrl } from '../../../utils/locale-utils';
import { getThemeById } from '../../../config/themes';

// Theme barrel files — only import selected themes
<% themes.forEach(theme => { %>
import * as <%= theme.id.charAt(0).toUpperCase() + theme.id.slice(1) %>Sections from '../../../components/sections/themes/<%= theme.id %>';
<% }) %>

export async function getStaticPaths() {
  const { getEnabledThemes } = await import('../../../config/themes');
  const { getEnabledLocaleCodes, defaultLocale } = await import('../../../config/locales');
  const themes = getEnabledThemes();
  const langs = getEnabledLocaleCodes();
  const paths = [];

  for (const lang of langs) {
    for (const theme of themes) {
      paths.push({
        params: {
          lang: lang === defaultLocale ? undefined : lang,
          theme: theme.id
        },
        props: { themeId: theme.id }
      });
    }
  }
  return paths;
}

interface Props {
  themeId: string;
}

const { themeId } = Astro.props;
const theme = getThemeById(themeId);
const locale = getLocaleFromUrl(Astro.url);
const t = useTranslations(locale);

const themeModules: Record<string, Record<string, unknown>> = {
<% themes.forEach(theme => { %>
  <%= theme.id %>: <%= theme.id.charAt(0).toUpperCase() + theme.id.slice(1) %>Sections,
<% }) %>
};

const sections = themeModules[themeId] ?? <%= themes[0].id.charAt(0).toUpperCase() + themes[0].id.slice(1) %>Sections;

const Header       = sections['Header']       as (_props: Record<string, unknown>) => unknown;
const PortfolioPage = (sections['PortfolioPage'] ?? null) as ((_props: Record<string, unknown>) => unknown) | null;
const Footer       = sections['Footer']       as (_props: Record<string, unknown>) => unknown;
---

<BaseLayout
  title={`${t('portfolioPage.pageTitle')} - ${theme?.name}`}
  description={t('portfolioPage.pageSubtitle')}
  showHeader={false}
>
  <Header />
  <main>
    {PortfolioPage ? (
      <PortfolioPage />
    ) : (
      <section class="min-h-screen flex items-center justify-center px-4 pt-32">
        <div class="text-center">
          <h1 class="text-4xl font-black text-base-content mb-4">{t('portfolioPage.pageTitle')}</h1>
          <p class="text-base-content/50 mb-8">{t('portfolioPage.comingSoon')}</p>
          <a
            href={`/${themeId}`}
            class="inline-flex items-center gap-2 text-accent font-bold hover:gap-4 transition-all duration-300"
          >
            ← {t('portfolioPage.backToHome')}
          </a>
        </div>
      </section>
    )}
  </main>
  <Footer />
</BaseLayout>
